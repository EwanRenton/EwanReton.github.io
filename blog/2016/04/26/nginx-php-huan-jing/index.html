
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Nginx下PHP环境搭建1 - Blog Like A Hacker</title>
  <meta name="author" content="Ewan Reton">

  
  <meta name="description" content="Nginx下PHP环境搭建1 一、需要准备的包 libiconv-1.7.tar.gz
libmcrypt-2.5.7.tar.gz
mcrypt-2.6.8.tar.gz
mhash-0.9.3.tar.gz
php-5.5.34.tar.bz2 二、具体安装 libiconv tar - &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ewanreton.github.io/blog/2016/04/26/nginx-php-huan-jing/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Blog Like A Hacker" type="application/atom+xml">
  <!-- font-family: 'Knewave', cursive; -->
<link href='http://fonts.googleapis.com/css?family=Knewave' rel='stylesheet' type='text/css'>
<!-- font-family: 'Cantata One', serif; -->
<link href='http://fonts.googleapis.com/css?family=Cantata+One' rel='stylesheet' type='text/css'>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1>
      <a href="/">Blog Like A Hacker</a>
      
        <span>不要被自己感动.</span>
      
  </h1>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.baidu.com" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ewanreton.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Nginx下PHP环境搭建1</h1>
    
    
      <p class="meta">
        








  


<time datetime="2016-04-26T22:53:05+08:00" pubdate data-updated="true"></time>
        
        
      </p>
    
  </header>


<div class="entry-content"><blockquote><p>Nginx下PHP环境搭建1</p></blockquote>

<h1>一、需要准备的包</h1>

<ul>
<li>libiconv-1.7.tar.gz</li>
<li>libmcrypt-2.5.7.tar.gz</li>
<li>mcrypt-2.6.8.tar.gz</li>
<li>mhash-0.9.3.tar.gz</li>
<li>php-5.5.34.tar.bz2</li>
</ul>


<h1>二、具体安装</h1>

<hr />

<ol>
<li><p>libiconv</p>

<ol>
<li>tar -zvxf libiconv-1.7.tar.gz</li>
<li>cd libiconv-1.7</li>
<li>./configure &ndash;prefix=/usr/local</li>
<li>make</li>
<li>make install</li>
</ol>
</li>
<li><p>libmcrypt</p>

<ol>
<li>tar -zvxf libmcrypt-2.5.7.tar.gz</li>
<li>cd libmcrypt-2.5.7</li>
<li>./configure</li>
<li>make</li>
<li>make install</li>
<li>/sbin/ldconfig   //共享链接库</li>
<li>./configure &ndash;enable-ltdl-install //内键指令</li>
<li>make</li>
<li>make install</li>
</ol>
</li>
<li><p>mhash</p>

<ol>
<li>tar -zvxf mhash-0.9.3.tar.gz</li>
<li>cd mhash-0.9.3</li>
<li>./configure</li>
<li>make</li>
<li>make install</li>
<li>ln -s /usr/local/lib/libmcrypt.la /usr/lib/ibmcrypt.la</li>
<li>ln -s /usr/local/lib/libmcrypt.la.so.4 /usr/lib/libmcrypt.la.so.4</li>
<li>ln -s /usr/local/lib/libmcrypt.la.so.4.4.8 /usr/lib/libmcrypt.la.so.4.4.8</li>
<li>ln -s /usr/local/lib/libmhash.a /usr/lib/libmhash.a</li>
<li>ln -s /usr/local/lib/libmhash.la /usr/lib/libmhash.la</li>
<li>ln -s /usr/local/lib/libmhash.so /usr/lib/libmhash.so</li>
<li>ln -s /usr/local/lib/libmhash.so.2 /usr/lib/libmhash.so.2</li>
<li>ln -s /usr/local/lib/libmhash.so.2.0.1 /usr/lib/libmhash.so.2.0.1</li>
</ol>
</li>
<li><p>mcrypt</p>

<ol>
<li>tar -zxvf mcrypt-2.6.8.tar.gz</li>
<li>cd mcrypt-2.6.8</li>
<li>/sbin/ldconfig</li>
<li>./configure</li>
<li>若报错则找不到LIBMCRYPT则

<ol>
<li>export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH</li>
<li>./configure -with-libmcryp-prefix=/usr/local</li>
</ol>
</li>
<li>make

<ol>
<li>报错打开报错的文件 vi /usr/local/include/mutils.h</li>
<li>找到报错的那行看是哪个文件引入失败(mhash_config.h)</li>
<li>find / -name mhash_config.h 在系统中找到该文件</li>
<li>cp /home/Ewan/下载/mhash-0.9.3/mhash_config.h /usr/local/include 拷贝到include文件下</li>
<li>make</li>
</ol>
</li>
<li>make install</li>
</ol>
</li>
<li><p>php-5.5.34.tar.bz2</p>

<ol>
<li>tar -jxvf php-5.5.34.tar.bz2</li>
<li>cd php-5.5.34</li>
<li>./configure &ndash;prefix=/usr/local/php &ndash;enable-fastcgi &ndash;enable-fpm

<ol>
<li>报错 yum install libxml2 libxml2-devel</li>
<li>./configure &ndash;prefix=/usr/local/php &ndash;enable-fastcgi &ndash;enable-fpm</li>
</ol>
</li>
<li>make ZEND_EXTRA_LIBS=&lsquo;-liconv&rsquo;</li>
<li>make install

<ol>
<li>报错 vi /etc/ld.so.conf</li>
<li>输入 /usr/local/lib</li>
<li>make install</li>
<li>如果还是出错 /sbin/ldconfig -v</li>
<li>make install</li>
<li>cp php.ini-dist /usr/local/php/etc/php.ini</li>
</ol>
</li>
</ol>
</li>
<li><p>mysql (5.5版本以下)</p>

<ol>
<li>groupadd mysql //添加组</li>
<li>useradd mysql -g mysql //添加用户</li>
<li>tar -zxvf mysql-x.x.x</li>
<li>cd mysql-x.x.x</li>
<li>./configure &ndash;prefix=/usr/local/mysql &ndash;with-mysqld-ldflags=-all-static &ndash;with-client-ldflags=-all-static &ndash;with-readline &ndash;with-ssl</li>
<li>/usr/local/mysql/bin/mysql_install_db &ndash;user//初始化数据库</li>
<li>cp ./support-files/mysql.server /etc/init.d/mysql //复制启动项到系统中</li>
<li>cp ./support-files/my-medium.cnf /etc/my.cnf</li>
<li>chmod 755 /etc/init.d/mysql(755 分别代表文件拥有者，同组者，其他人的权限 rwx 7为111 可读可写可执行)</li>
<li>cd /usr/local/mysql</li>
<li>chown -R mysql . //将拥有者更改为mysql用户</li>
<li>chgrp -R mysql . //归到mysql组</li>
<li>/usr/local/mysql/bin/mysqladmin -u root password &lsquo;abc123&rsquo; //设置数据库密码</li>
<li>报错 不能连接到local mysql</li>
<li>ps -ef|grep mysql //找到mysql对应的进程号</li>
<li>kill -9 xxxx //杀死进程</li>
<li>/usr/local/mysql/bin/mysql_install_db &ndash;user//初始化数据库</li>
<li>service mysql start //启动MYSQL</li>
<li>/usr/local/mysql/bin/mysqladmin -u root password &lsquo;abc123&rsquo; //设置数据库密码</li>
<li>/usr/local/mysql/bin/mysql -u root -p //测试输入的密码</li>
<li>进入到mysql 后可以\q退出</li>
</ol>
</li>
<li>安装mysql（5.5版本）
  <a href="http://www.mysql.com/">下载Mysql5.5.4</a></li>
</ol>


<p><img src="http://shp.qpic.cn/txdiscuz_pic/0/_bbs_qcloud_com_forum_201503_10_171832lw4gbxwhq9z9vmho.png/0" alt="1" /></p>

<p><img src="http://shp.qpic.cn/txdiscuz_pic/0/_bbs_qcloud_com_forum_201503_10_171836mubv0eb5010ewbjv.png/0" alt="1" /></p>

<pre><code>1. tar zxvf mysql-5.5.40.tar.gz
2. cd mysql-5.5.4
3. yum install ncurses-devel cmake bison-devel libaio-devel gcc-c++ bison -y 
    *  mysql5.5 版本之后，预编译的 configure命令改为了 cmake, 需要手动安装一下 cmake命令
5.  cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_DATADIR=/usr/local/mysql/data -DSYSCONFDIR=/etc -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci-- Library mysqlclient depends on OSLIBS -lpthread;m;rt;dl-- Configuring done-- Generating done-- Build files have been written to: /root/mysql-5.5.40 ————预编译无报错，成功。
*  make 
    *  [100%] Building CXX object mysql-test/lib/My/SafeProcess/CMakeFiles/my_safe_process.dir/safe_process.cc.oLinking CXX executable my_safe_process[100%] Built target my_safe_process————无报错，make正常。
*   make install -- Installing: /usr/local/mysql/man/man1/mysql_fix_extensions.1 -- Installing: /usr/local/mysql/man/man1/mysqldumpslow.1 -- Installing: /usr/local/mysql/man/man1/mysql_secure_installation.1 -- Installing: /usr/local/mysql/man/man8/mysqld.8 ————无报错，make install正常。
*    groupadd mysql ————创建mysql组
*     useradd -g mysql mysql ————在mysql组中创建mysql用户
* cp /usr/local/mysql/support-files/my-medium.cnf /etc/my.cnf ————默认没有mysql的配置文件，将源码包中的配置文件拷贝到etc下的配置文件中。
*  /usr/local/mysql/scripts/mysql_install_db --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data ————初始化数据库，指定用户为mysql，家目录为/usr/local/mysql，数据库目录为/usr/local/mysql/data
* chown -R root /usr/local/mysql/ ————改变目录的所有者
* chown -R mysql /usr/local/mysql/data ————改变目录的所有者
* chgrp -R mysql /usr/local/mysql/ ————改变目录的所属组
*  export PATH=$PATH:/usr/local/mysql/bin ————将/usr/local/mysql/bin下的命令放到环境变量中
*   /usr/local/mysql/bin/mysqld_safe --user=mysql &amp; ————启动mysql
* mysql 
    *  Welcome to the MySQL monitor.  Commands end with ; or \g.
         Your MySQL connection id is 1
</code></pre>

<blockquote><p>ps:在实际的操作过程中上面在10步初始化数据库时有可能会error这时可以考虑用</p></blockquote>

<pre><code> ps -ef|grep mysql //找到mysql对应的进程号
 kill -9 xxxx //杀死进程
</code></pre>

<blockquote><p>然后执行</p></blockquote>

<pre><code> chown -R root /usr/local/mysql/ ————改变目录的所有者
 chown -R mysql /usr/local/mysql/data ————改变目录的所有者
 chgrp -R mysql /usr/local/mysql/ ————改变目录的所属组
 export PATH=$PATH:/usr/local/mysql/bin ————将/usr/local/mysql/bin下的命令放到环境变量中
 /usr/local/mysql/scripts/mysql_install_db --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data ————初始化数据库，指定用户为mysql，家目录为/usr/local/mysql，数据库目录为/usr/local/mysql/data
 /usr/local/mysql/bin/mysqld_safe &amp; 启动Mysql 或者
 /usr/local/mysql/bin/mysqld_safe --user=mysql &amp; ————启动mysql
 在执行以下操作
</code></pre>

<h2>Mysql启动、停止的方法</h2>

<pre><code>/usr/local/mysql/bin/mysqld_safe --user=mysql &amp;      启动
mysqladmin –uroot –pxxx  shutdown                  停止
tail -f /var/log/mysqld.log                        查看mysql的错误日志
</code></pre>

<h3>修改 mysql监听地址为127.0.0.1</h3>

<pre><code>netstat -ntulp
tcp        0      0 0.0.0.0:3306                0.0.0.0:*                   LISTEN      28253/mysqld       
tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      1889/sshd    
</code></pre>

<p>默认是监听的0.0.0.0</p>

<pre><code>vi /etc/my.cnf
添加一列
[mysqld]
port            = 3306
socket          = /tmp/mysql.socK
bind-address=127.0.0.1
# mysqladmin -uroot -p shutdow
# /usr/local/mysql/bin/mysqld_safe --user=mysql &amp;
保存并退出
 netstat -ntulp
tcp        0      0 127.0.0.1:3306              0.0.0.0:*                   LISTEN      29103/mysqld   
</code></pre>

<p>————修改成功</p>

<h2>修改 mysql的root密码</h2>

<pre><code>use mysql
update user set Password=PASSWORD('新密码') where User='root' and Host='localhost';
flush privileges;flush privileges;
# mysql -uroot -p
Enter password:
mysql&gt;
</code></pre>

<p>————修改新密码成功</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Ewan Reton</span></span>

      








  


<time datetime="2016-04-26T22:53:05+08:00" pubdate data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/nginx/'>nginx</a>, <a class='category' href='/blog/categories/php/'>php</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/04/26/linux-chang-yong-min-ling/" title="Previous Post: Linux-chang-yong-min-ling">&laquo; Linux-chang-yong-min-ling</a>
      
      
        <a class="basic-alignment right" href="/blog/2016/04/28/qqyuncontos-huan-jing-da-jian/" title="Next Post: 腾讯云服务器Centos6.5 LNMP环境搭建">腾讯云服务器Centos6.5 LNMP环境搭建 &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section class="first odd">
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/04/29/php-seaslog/">PHP高性能日志SeasLog</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/29/wu-xian-ji-fen-lei/">PHP无限级分类</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/28/linux-mysql-code/">Linux-MYSQL-常用命令</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/28/qqyuncontos-huan-jing-da-jian/">腾讯云服务器Centos6.5 LNMP环境搭建</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/26/nginx-php-huan-jing/">Nginx下PHP环境搭建1</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Ewan Reton -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> and <a href="https://github.com/gluttony/object-octopress-theme">Object</a></span>
</p>

</footer>
  











</body>
</html>
